@model List<OurPlace.Models.Group.GroupViewModel>
@{
    ViewData["Title"] = "Groups";
}
@section Styles {
    <link rel="stylesheet" href="~/css/Groups.css" />
    <link rel="stylesheet" href="~/css/Profile.css" />
}

<partial name="./Partials/_createGroupForm" />

<div class="container">
    <div class="headerContainer">
        <h3>My groups</h3>
        <div class="btn btn-primary" onclick="toggleForm(`groupForm`)">Create group</div>
    </div>
    <br /><br />
    <div class="tableContainer">
        @if (Model.Count == 0)
        {
            <h3>You are not joined in any groups</h3>
        }
        else
        {
            <table class="table table-striped text-center">
                <thead>
                    <tr>
                        <th>Group name</th>
                        <th>Admin name</th>
                        <th>Members</th>
                        <th>Date created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var group in Model)
                    {
                        <tr>
                            <td>@group.Name</td>
                            <td>@group.GroupAdminName</td>
                            <td>@group.MembersCount</td>
                            <td>@group.DateCreated.ToString("MMM dd, yyyy")</td>
                            <td>
                                <a asp-controller="Group" asp-action="LeaveGroup" asp-route-groupId="@group.Id">Leave</a> |
                                <a asp-controller="Group" asp-action="AddPeople" asp-route-groupId="@group.Id" asp-route-userId="@User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier).Value">Add people</a> |
                                <a asp-controller="Group" asp-action="JoinGroup" asp-route-groupId="@group.Id">Join</a> |
                                @if (group.GroupAdminId == User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier).Value)
                                {
                                    <a asp-controller="Group" asp-action="Delete" asp-route-groupId="@group.Id">Delete</a>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }

    </div>
</div>

@section Scripts {
    <script src="~/js/Profile.js"></script>
    <script src="~/js/Group.js"></script>
}